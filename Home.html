<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ClassCount</title>
<style>
     body {
        font-family: 'Segoe UI', sans-serif;
        margin: 0;
        background-color: #f4f6fa;
        color: #333;
    }

    header {
        background-color: #243b8f;
        color: white;
        padding: 1rem 2rem;
        text-align: center;
        box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }

    header h1 {
        margin: 0;
        font-size: 1.6rem;
    }

    main {
        padding: 2rem;
        max-width: 1100px;
        margin: auto;
    }

    h2 {
        margin-bottom: 1rem;
        font-size: 1.4rem;
        color: #222;
    }

    .card-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
    }

    .lecture-card {
        background: white;
        padding: 1.5rem;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .lecture-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 16px rgba(0,0,0,0.12);
    }

    .lecture-title {
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 0.3rem;
    }

    .lecture-date {
        font-size: 0.9rem;
        color: #666;
        margin-bottom: 0.3rem;
    }

    .lecture-time {
        font-size: 0.9rem;
        color: #888;
        margin-bottom: 1rem;
    }

    .lecture-stats {
        font-size: 1rem;
        font-weight: bold;
        color: #2a7a1f;
        margin-bottom: 1rem;
    }

    .view-btn {
        display: inline-block;
        padding: 0.5rem 1rem;
        background-color: #243b8f;
        color: white;
        border-radius: 6px;
        text-decoration: none;
        font-weight: 500;
        transition: background-color 0.3s ease;
    }

    .view-btn:hover {
        background-color: #1b2e6d;
    }

    footer {
        text-align: center;
        padding: 1rem;
        font-size: 0.85rem;
        color: #777;
        margin-top: 2rem;
    }
</style>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

<header>
    <h1>ClassCount</h1>
</header>

<main>
    <h2>Recent Lectures</h2>
    <div class="card-container" id="lectures-container"></div>
</main>

<footer>
    Made by Developers of BAFs App.
</footer>

<script>
    // Initialize Supabase
    const SUPABASE_URL = "https://pwgdubtbvqnmivtupbvx.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB3Z2R1YnRidnFubWl2dHVwYnZ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUwOTUzMTAsImV4cCI6MjA3MDY3MTMxMH0.kCn6JMv0kTQrkoJ7OmaxCbwZNzewRNtuOg-35nYXYXg";
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    async function loadLectures() {
        const { data, error } = await supabase
            .from("lectures") // Replace with your actual table name
            .select("*")
            .order("NO", { ascending: false });

        if (error) {
            console.error("Error fetching lectures:", error);
            return;
        }

        const container = document.getElementById("lectures-container");
        container.innerHTML = "";

        data.forEach(lecture => {
            const presentCount = lecture.IDS ? lecture.IDS.split(",").filter(id => id.trim() !== "").length : 0;
            const card = document.createElement("div");
            card.classList.add("lecture-card");

            card.innerHTML = `
                <div class="lecture-title">${lecture.LECTURE}</div>
                <div class="lecture-date">Date: ${lecture.DATE}</div>
                <div class="lecture-time">Time: ${lecture.TIME}</div>
                <div class="lecture-stats">Present: ${presentCount}</div>
                <a href="view.html?no=${lecture.NO}" class="view-btn">View Attendance</a>
            `;

            container.appendChild(card);
        });
    }

    loadLectures();
</script>

</body>
</html>
